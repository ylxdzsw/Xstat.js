(r=>{"use strict";function t(r){if(r<.5)return a/(l(a*r)*t(1-r));{r-=1;let e=t.p[0];for(var n=1;n<t.g+2;n++)e+=t.p[n]/(r+n);const i=r+t.g+.5;return N(2*a)*i**(r+.5)*f(-i)*e}}function n(r){const t=o(r);return t>=2**53?v(r):t<=.46875?v(r)*n.erf1(t):t<=4?v(r)*(1-n.erfc2(t)):v(r)*(1-n.erfc3(t))}class NA{}const e=new NA,i=Float64Array;r.NA=NA,r.na=e,r.Sample=class Sample{};class Distribution{}class Normal extends Distribution{get"σ"(){return this.σ2 instanceof NA?e:N(this.σ2)}constructor(r=e,t=e){super(),this.μ=r,this.σ2=t}pdf(r){const{"μ":t,"σ2":n}=this;if(t instanceof NA||n instanceof NA)throw new Error("distribution contains unknown parameters");return 1/N(2*a*n)*f((r-t)**2/-2/n)}sample(r){const{"μ":t,"σ":n}=this;if(t instanceof NA||n instanceof NA)throw new Error("distribution contains unknown parameters");if(r){const e=new i(r);for(let i=0;i<r/2;i++)[e[2*i],e[2*i+1]]=Normal._gaussian_pair(t,n);return r%2&&(e[e.length-1]=Normal._gaussian_pair(t,n)[0]),e}return Normal._gaussian_pair(t,n)[0]}}(Normal||(Normal={}))._gaussian_pair=((r,t)=>{const n=N(-2*d(_()))*t,e=2*a*_();return[n*p(e)+r,n*l(e)+r]});class Empirical extends Distribution{constructor(r,t){super(),this.data=r,this.weights=t?Empirical.normalize(t):new i(r.length).fill(1/r.length)}sample(r){if(r)return new i(r).map(r=>this.sample());let t=_();for(let r=0;r<this.data.length;r++){if(t<this.weights[r])return this.data[r];t-=this.weights[r]}}}(Empirical||(Empirical={})).normalize=(r=>{const t=r.reduce((r,t)=>r+t);return r.map(r=>r/t)}),r.distributions={Normal,Uniform:class Uniform extends Distribution{get len(){return this.ub-this.lb}constructor(r,t){super(),this.lb=r,this.ub=t}pdf(r){return 1/this.len}sample(r){const{lb:t,len:n}=this;return r?new i(r).map(r=>t+_()*n):t+_()*n}},Empirical};const{E:s,PI:a,abs:o,sin:l,cos:p,tan:c,exp:f,floor:u,ceil:m,round:h,trunc:g,log:d,max:w,min:b,sqrt:N,sign:v,random:_}=Math;!function(r){r.g=7,r.p=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7]}(t||(t={})),function(r){const t=[[3.1611237438705655,113.86415415105016,377.485237685302,3209.3775891384694,.18577770618460315],[.5641884969886701,8.883149794388377,66.11919063714163,298.6351381974001,881.952221241769,1712.0476126340707,2051.0783778260716,1230.3393547979972,2.1531153547440383e-8],[.30532663496123236,.36034489994980445,.12578172611122926,.016083785148742275,.0006587491615298378,.016315387137302097]],n=[[23.601290952344122,244.02463793444417,1282.6165260773723,2844.236833439171],[15.744926110709835,117.6939508913125,537.1811018620099,1621.3895745666903,3290.7992357334597,4362.619090143247,3439.3676741437216,1230.3393548037495],[2.568520192289822,1.8729528499234604,.5279051029514285,.06051834131244132,.0023352049762686918]];r.erf1=(r=>{var e,i=r*r,s=t[0][4]*i,a=i;for(e=0;e<3;e+=1)s=(s+t[0][e])*i,a=(a+n[0][e])*i;return r*(s+t[0][3])/(a+n[0][3])}),r.erfc2=(r=>{var e,i=t[1][8]*r,s=r;for(e=0;e<7;e+=1)i=(i+t[1][e])*r,s=(s+n[1][e])*r;var a=(i+t[1][7])/(s+n[1][7]),o=g(16*r)/16,l=(r-o)*(r+o);return Math.exp(-o*o)*Math.exp(-l)*a}),r.erfc3=(r=>{var e,i=1/(r*r),s=t[2][5]*i,a=i;for(e=0;e<4;e+=1)s=(s+t[2][e])*i,a=(a+n[2][e])*i;var o=i*(s+t[2][4])/(a+n[2][4]);o=(.5641895835477563-o)/r;var l=(r-(i=g(16*r)/16))*(r+i);return Math.exp(-i*i)*Math.exp(-l)*o})}(n||(n={}));r.math={"Γ":t,erf:n,combination:(r,t)=>{t=w(t,r-t);let n=1;for(let e=1;e<=r-t;e++)n*=(t+e)/e;return n}};var A;!function(r){r.inversion=(r=>r.n?r.f_rev(Math.random()):new Float64Array(r.n||1).map(t=>r.f_rev(Math.random()))),r.rejection=(r=>{const{pdf:t,envelope:n,M:e=(r=>1.05*r),n:s=1}=r;let a;if("number"==typeof e)a=new i(s).map(r=>{for(;;){const r=n.sample();if(_()<t(r)/e/n.pdf(r))return r}});else if("function"==typeof e){let r=[],o="number"==typeof e?e:1.2;for(;r.length<s;){const i=n.sample(),s=t(i)/o/n.pdf(i),a=_();if(s>1){if("function"!=typeof e)throw new Error("f(Y) / Mg(Y) > 1, try bigger M");{const t=e(s);o*=t,r=r.map(([r,n])=>[r,n/t]).filter(([r,t])=>t>1)}}a<s&&r.push([i,s/a])}a=new i(r.map(r=>r[0]))}return r.n?a:a[0]}),r.sampling_importance_resampling=(r=>{const{pdf:t,proposal:n,n:e=1,J:i=10*(e+10)}=r,s=n.sample(i),a=s.map(r=>t(r)/n.pdf(r)),o=new Empirical(s,a).sample(e);return r.n?o:o[0]})}(A||(A={})),r.sampling=A})(exports||(this.Xstat={}));
//# sourceMappingURL=xstat.map